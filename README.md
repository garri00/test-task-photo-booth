# Test task photo booth

The goal is to create an HTTP API for uploading, optimizing, and serving images.
1. The API should expose an endpoint for uploading an image. After uploading, the image should be sent for optimization via a queue (e.g. RabbitMQ) to prevent excessive system load in case of many parallel image uploads and increase the system durability.
2. Uploaded images should be taken from the queue one by one and optimized using the github.com/h2non/bimg go package (or github.com/nfnt/resize package). For each original image, three smaller-size image variants should be generated and saved, with 75%, 50%, and 25% quality.
3. The API should expose an endpoint for downloading an image by ID. The endpoint should allow specifying the image optimization level using query parameters (e.g. ?quality=100/75/50/25 ). 


## Routes implemented

- **POST** 127.0.0.1:8080/api/photo
```json
{
    "data": "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",
}
```

- **GET** 127.0.0.1:8080/api/photo/c2d75aca-1dcd-41f2-adf4-f74ccb52febe?quality=25

```json
{
    "id": "c2d75aca-1dcd-41f2-adf4-f74ccb52febe",
    "data": "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",
    "isDeleted": false
}
```

- **DELETE** 127.0.0.1:8080/api/photo/c2d75aca-1dcd-41f2-adf4-f74ccb52febe
```json
{
    "status": "ok"
}
```

## Service

PostgresDB and RabbitMQ runs from docker compose. 
Main.go service runs from cmd